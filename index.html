<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PENILAIAN PEKAN EVALUASI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">PEKAN EVALUASI</a>
        <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link active" href="#" onclick="showPage('dataPage')">Data</a></li>
            <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('inputPage')">Input</a></li>
        </ul>
    </div>
</nav>

<!-- DATA PAGE -->
<div id="dataPage" class="container mt-4">
    <h3 class="text-primary">DATA SISWA</h3>

    <button class="btn btn-success mb-3" onclick="addStudent()">+ Tambah Siswa</button>

    <table class="table table-bordered table-striped">
        <thead class="table-primary">
            <tr>
                <th>No Absen</th>
                <th>Nama</th>
                <th>Kelas</th>
                <th>NIS</th>
                <th>NISN</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody id="studentTable"></tbody>
    </table>
</div>

<!-- INPUT PAGE -->
<div id="inputPage" class="container mt-4" style="display:none;">

    <h3 class="text-primary">INPUT NILAI</h3>

    <!-- IDENTITAS OTOMATIS -->
    <div class="card p-3 mb-3">
        <strong>Nama Sekolah:</strong> SD Negeri Contoh 01<br>
        <strong>Alamat:</strong> Jl. Pendidikan No. 12<br>
        <strong>Tahun Ajaran:</strong> 2025 / 2026
    </div>

    <div class="card p-3">

        <!-- FORM SISWA -->
        <div class="mb-3">
            <label class="form-label">Nama Siswa</label>
            <input id="inputNama" class="form-control" readonly>
        </div>

        <div class="mb-3">
            <label class="form-label">Kelas</label>
            <input id="inputKelas" class="form-control" readonly>
        </div>

        <hr>

        <!-- PE 1 -->
        <h5>PE 1</h5>
        <div id="pe1Container"></div>
        <button class="btn btn-outline-primary btn-sm mt-2" onclick="addPE('pe1Container')">+ Tambah Nilai PE 1</button>

        <hr>

        <!-- PE 2 -->
        <h5>PE 2</h5>
        <div id="pe2Container"></div>
        <button class="btn btn-outline-primary btn-sm mt-2" onclick="addPE('pe2Container')">+ Tambah Nilai PE 2</button>

        <hr>

        <!-- PE 3 -->
        <h5>PE 3</h5>
        <div id="pe3Container"></div>
        <button class="btn btn-outline-primary btn-sm mt-2" onclick="addPE('pe3Container')">+ Tambah Nilai PE 3</button>

        <hr>

        <button class="btn btn-success" onclick="saveValues()">Simpan Nilai</button>
    </div>
</div>

<script>
let students = [];

function showPage(page) {
    document.getElementById("dataPage").style.display = "none";
    document.getElementById("inputPage").style.display = "none";
    document.getElementById(page).style.display = "block";
}

function addStudent() {
    let no = prompt("Masukkan No Absen:");
    let nama = prompt("Nama siswa:");
    let kelas = prompt("Kelas:");
    let nis = prompt("NIS:");
    let nisn = prompt("NISN:");

    if(!nama) return;

    students.push({
        no,
        nama,
        kelas,
        nis,
        nisn,
        pe1: [],
        pe2: [],
        pe3: []
    });

    renderTable();
}

function renderTable() {
    let html = "";
    students.forEach((s, i) => {
        html += `
            <tr>
                <td>${s.no}</td>
                <td>${s.nama}</td>
                <td>${s.kelas}</td>
                <td>${s.nis}</td>
                <td>${s.nisn}</td>
                <td>
                    <button class="btn btn-warning btn-sm" onclick="editStudent(${i})">Input</button>
                    <button class="btn btn-info btn-sm">Print</button>
                </td>
            </tr>
        `;
    });
    document.getElementById("studentTable").innerHTML = html;
}

let currentIndex = null;

function editStudent(index) {
    currentIndex = index;
    let s = students[index];

    document.getElementById("inputNama").value = s.nama;
    document.getElementById("inputKelas").value = s.kelas;

    document.getElementById("pe1Container").innerHTML = "";
    document.getElementById("pe2Container").innerHTML = "";
    document.getElementById("pe3Container").innerHTML = "";

    s.pe1.forEach(v => addPE("pe1Container", v));
    s.pe2.forEach(v => addPE("pe2Container", v));
    s.pe3.forEach(v => addPE("pe3Container", v));

    showPage("inputPage");
}

function addPE(containerId, value = "") {
    let div = document.createElement("div");
    div.className = "input-group mb-2";

    div.innerHTML = `
        <input type="number" class="form-control peValue" value="${value}">
        <button class="btn btn-danger" onclick="this.parentElement.remove()">X</button>
    `;

    document.getElementById(containerId).appendChild(div);
}

function saveValues() {
    let s = students[currentIndex];

    s.pe1 = [...document.querySelectorAll("#pe1Container .peValue")].map(i => i.value);
    s.pe2 = [...document.querySelectorAll("#pe2Container .peValue")].map(i => i.value);
    s.pe3 = [...document.querySelectorAll("#pe3Container .peValue")].map(i => i.value);

    alert("Nilai berhasil disimpan!");
    showPage("dataPage");
    renderTable();
}
</script>

</body>
</html>
