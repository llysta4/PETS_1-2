<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PENILAIAN PEKAN EVALUASI - SD GRACIA 2</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f0f6ff;
        }

        .page {
            display: none;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0px 0px 12px #cfe0ff;
        }
        .active {
            display: block;
        }

        .nilai-box {
            border: 1px solid #cfe0ff;
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 6px;
            background: #f7faff;
        }

        .mapel-container {
            border: 1px solid #d0e2ff;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 18px;
            background: #f9fbff;
        }

        .mapel-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .mapel-item {
            background: #e8f0ff;
            border-radius: 10px;
            padding: 10px;
            flex: 1 1 calc(33% - 10px);
            min-width: 250px;
        }

        .pe-group {
            display: flex;
            gap: 6px;
        }

        @media print {
            body {
                background: white;
            }
            .nav, .btn, .nav-tabs {
                display: none !important;
            }
            .page {
                box-shadow: none;
                padding: 0;
            }

            /* PE1 PE2 PE3 jadi VERTIKAL */
            .mapel-row {
                display: block !important;
            }
            .mapel-item {
                width: 100% !important;
                margin-bottom: 15px;
                page-break-inside: avoid;
            }
            .pe-group {
                display: block !important;
            }
            .pe-group input {
                width: 100% !important;
            }

            #print-header {
                display: block !important;
            }
        }

        #print-header {
            display: none;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 12px;
            background: #e5efff;
            border: 1px solid #aac6ff;
        }

        .ttd-area {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
        }

        .ttd-box {
            text-align: center;
            width: 40%;
        }

        .ttd-line {
            border-top: 1px solid #000;
            margin-top: 70px;
            width: 100%;
        }
    </style>
</head>

<body class="p-3">

<!-- NAV -->
<ul class="nav nav-tabs mb-3">
    <li class="nav-item">
        <button class="nav-link active" onclick="showPage(1)">Halaman 1 (Data)</button>
    </li>
    <li class="nav-item">
        <button class="nav-link" onclick="showPage(2)">Halaman 2 (Kelas 1)</button>
    </li>
    <li class="nav-item">
        <button class="nav-link" onclick="showPage(3)">Halaman 3 (Kelas 2)</button>
    </li>
</ul>

<!-- PRINT HEADER -->
<div id="print-header">
    <h3 class="text-center fw-bold">PEKAN EVALUASI SEMESTER GANJIL</h3>

    <div id="identitas-container" class="mt-3">
        <p>Nama: <span id="print-nama"></span></p>
        <p>Kelas: <span id="print-kelas"></span></p>
        <p>NIS: <span id="print-nis"></span></p>
        <p>NISN: <span id="print-nisn"></span></p>
        <p>Semester: Ganjil</p>
        <p>Fase: A</p>
        <p>Nama Sekolah: SD Gracia 2 Bandung</p>
        <p>Alamat Sekolah: JL. Pargasih no.256, Jamika, Kota Bandung</p>
        <p>Tahun Ajaran: 2024 / 2025</p>
    </div>
</div>

<!-- PAGE 1 -->
<div id="page1" class="page active">
    <h3 class="text-center fw-bold mb-2">DATA NILAI SISWA</h3>

    <table class="table table-bordered text-center bg-white">
        <thead class="table-primary">
            <tr>
                <th>No</th>
                <th>Nama</th>
                <th>Kelas</th>
                <th>NIS</th>
                <th>NISN</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody id="dataTable"></tbody>
    </table>
</div>

<!-- PAGE 2 KELAS 1 -->
<div id="page2" class="page">
    <h3 class="text-center fw-bold">INPUT NILAI – KELAS 1</h3>
    <div id="kelas1"></div>

    <button class="btn btn-primary w-100 mt-3" onclick="simpanSemua()">SIMPAN SEMUA NILAI</button>
</div>

<!-- PAGE 3 KELAS 2 -->
<div id="page3" class="page">
    <h3 class="text-center fw-bold">INPUT NILAI – KELAS 2</h3>
    <div id="kelas2"></div>

    <button class="btn btn-primary w-100 mt-3" onclick="simpanSemua()">SIMPAN SEMUA NILAI</button>
</div>

<script>
// ========================= DATA ===============================

const kelas1 = [
    { nama: "KHENSI RAFALDI PRIYADI", nis: "252601001", nisn: "-", mapel: 10 },
    { nama: "KIMBERLY BELLVANIA HERYANTO", nis: "252601002", nisn: "317378079", mapel: 10 },
    { nama: "YOSIA CHARISDEO DEIS", nis: "252601008", nisn: "-", mapel: 10 }
];

const kelas2 = [
    { nama: "STELLA ANGELINA YANUBI", nis: "242501003", nisn: "3176946273", mapel: 11 },
    { nama: "FADHIL BAYU AQIRIN", nis: "252602006", nisn: "-", mapel: 11 },
    { nama: "GWYNETH TANUWIDJAJA", nis: "252602004", nisn: "3169999681", mapel: 11 }
];

const mapelList = [
    "PABP","PP","BAHASA INDONESIA","MATEMATIKA","PJOK",
    "SBDP","BAHASA SUNDA","PLH","BAHASA INGGRIS","TIK"
];

// ========================= PAGE SWITCH ===============================

function showPage(no) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.getElementById("page" + no).classList.add("active");

    document.querySelectorAll(".nav-link").forEach(n => n.classList.remove("active"));
    document.querySelectorAll(".nav-link")[no - 1].classList.add("active");
}

// ========================= RENDER HALAMAN 1 ===============================

function renderTable() {
    const table = document.getElementById("dataTable");
    table.innerHTML = "";
    let nomor = 1;

    kelas1.forEach(s => {
        table.innerHTML += tr(nomor++, s.nama, "1", s.nis, s.nisn);
    });
    kelas2.forEach(s => {
        table.innerHTML += tr(nomor++, s.nama, "2", s.nis, s.nisn);
    });
}

function tr(no, nama, kelas, nis, nisn) {
    return `
    <tr>
        <td>${no}</td>
        <td>${nama}</td>
        <td>${kelas}</td>
        <td>${nis}</td>
        <td>${nisn}</td>
        <td><button class="btn btn-info btn-sm" onclick="printPerOrang('${nama}','${kelas}','${nis}','${nisn}')">Print</button></td>
    </tr>`;
}

// ========================= PRINT PER ORANG ===============================

function printPerOrang(nama, kelas, nis, nisn) {
    document.getElementById("print-nama").innerText = nama;
    document.getElementById("print-kelas").innerText = kelas;
    document.getElementById("print-nis").innerText = nis;
    document.getElementById("print-nisn").innerText = nisn;

    window.print();
}

// ========================= INPUT NILAI ===============================

function renderInput() {
    renderKelas("kelas1", kelas1);
    renderKelas("kelas2", kelas2);
}

function renderKelas(divID, data) {
    const div = document.getElementById(divID);
    div.innerHTML = "";

    data.forEach(siswa => {
        div.innerHTML += `
        <div class="mapel-container">
            <h5>${siswa.nama}</h5>
            <p>NIS: ${siswa.nis} | NISN: ${siswa.nisn}</p>
            <div class="mapel-row">
                ${mapelList.map(m => mapelItem(siswa.nama, m)).join("")}
            </div>
        </div>`;
    });
}

function mapelItem(nama, mapel) {
    return `
    <div class="mapel-item">
        <h6>${mapel}</h6>

        <div class="pe-group">
            <div><label>PE1</label><input type="number" id="${nama}-${mapel}-PE1" class="form-control nilai-box"></div>
            <div><label>PE2</label><input type="number" id="${nama}-${mapel}-PE2" class="form-control nilai-box"></div>
            <div><label>PE3</label><input type="number" id="${nama}-${mapel}-PE3" class="form-control nilai-box"></div>
        </div>
    </div>`;
}

// ========================= SIMPAN NILAI ===============================

function simpanSemua() {
    const inputs = document.querySelectorAll("input");
    let data = {};

    inputs.forEach(i => {
        data[i.id] = i.value;
    });

    localStorage.setItem("nilaiPE", JSON.stringify(data));
    alert("Data berhasil disimpan!");
}

// ========================= START ===============================

renderTable();
renderInput();

</script>

</body>
</html>
